{% extends 'base.html' %}
{% load staticfiles %}
{% load i18n %}

{% block extra_stylesheets %}
<link rel="stylesheet" href="{% static 'assets/tag/css/bootstrap-tokenfield.min.css' %}">
<link rel="stylesheet" href="{% static 'assets/tag/css/tokenfield-typeahead.css' %}">
{% endblock %}

{% block body%}
<div class="col-md-6 col-md-offset-3">		
	<form action="" enctype="multipart/form-data" method="post">
	  {% csrf_token %}
	  <fieldset>
	    <legend>{% trans "Create Project" %}</legend>
	    {{ form.non_field_errors }}
	    {% for field in form %}
	    {{ field.errors }}
	    {% if field.name == 'budget'%}
	    {{field.label_tag}}
	    <div class="input-group">
	        <span class="input-group-addon">US $</span>
	        {{ field }}
	        <br>
	    </div>
        {% elif field.name == 'time_frame'%}
        {{field.label_tag}}
	    <div class="form-group">
	        <div class="col-sm-6">
	            {{field}}
	        </div>
	        {% elif field.name == 'time_frame_unit'%}
	        <div class="col-sm-6">
	            {{field}}
	        </div>
		    <br>
	    </div>
	    <br>
		{% else %}
		<p>
		{{ field.label_tag }}
		{{ field }}
		</p>
	    {% endif %}
	    {% endfor %}
	  </fieldset>
	  <input type="submit"  class="btn btn-success btn-block btn-lg"  value="{% trans "Save changes" %}" />
	</form>
</div>
{% endblock %}

{% block extra_script %}
<script src="{% static 'assets/typeahead.js' %}"></script>
<script src="{% static 'assets/tag/js/bootstrap-tokenfield.min.js' %}"></script>
<script>
	var engine = new Bloodhound({
	  local: {{skills|safe}},
	  datumTokenizer: function(d) {
	    return Bloodhound.tokenizers.whitespace(d.value); 
	  },
	  queryTokenizer: Bloodhound.tokenizers.whitespace    
	});

	engine.initialize();

	$('#id_skills').tokenfield({
	  typeahead: [null, { source: engine.ttAdapter() }]
	});
	
	$('#id_skills').on('tokenfield:createtoken', function (event) {
	    var existingTokens = $(this).tokenfield('getTokens');
	    $.each(existingTokens, function(index, token) {
	        if (token.value === event.attrs.value)
	            event.preventDefault();
	    });
	});
</script>
{%endblock%}
